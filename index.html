<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="description" content="Currently leading product design at Sidewire in San Francisco, California.">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- Tachyons v4.5.5 -->
        <link rel="stylesheet" href="tachyons.min.css">
        <title>Michael Schultz</title>
        <style>
            .darken::after {
                background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0) 0%, rgba(0, 0, 0, 0.35) 70%, rgba(0, 0, 0, 0.7) 100%);
                content: '';
                position: absolute;
                width: 100%;
                height: 100%;
                top: 0;
                left: 0;
            }
            .flexer {
                display: flex;
            }
            @media only screen and (max-width: 479px) {
                .flexer {
                    display: block !important;
                }
            }
        </style>
        <script> 
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

            ga('create', 'UA-534843-30', 'auto');
            ga('send', 'pageview');

            function trackOutboundLink(url) {
               ga('send', 'event', 'outbound', 'click', url, {
                 'transport': 'beacon',
                 'hitCallback': function(){document.location = url;}
               });
            }
        </script>
    </head>
    <body class="mw7 center pa3">
        <section>
            <header class="bg-white black-80 tc pv4 avenir">
                <img src="michael_schultz.jpg" class="bg-black-80 ba b--black dib w4 h4 br2"/>
                <h1 class="mt2 mb0 baskerville i fw1 f1">Michael Schultz</h1>
                <h2 class="mt4 mb0 f6 fw4 ttu lh-copy tracked">Currently leading product design at <a class="link hover-dark-blue no-underline blue" href="http://sidewire.com" onclick="trackOutboundLink('http://sidewire.com'); return false;">Sidewire</a> in San Francisco, California.</h2>
                <nav class="bt bb tc mw7 center mt4">
                    <a class="f6 f5-l link bg-animate black-80 hover-bg-light-blue dib pa3 ph4-l"
                        href="http://twitter.com/michaelschultz"
                        onclick="trackOutboundLink('http://twitter.com/michaelschultz'); return false;">
                        Twitter
                    </a> 
                    <a class="f6 f5-l link bg-animate black-80 hover-bg-light-green dib pa3 ph4-l"
                        href="http://github.com/michaelwschultz"
                        onclick="trackOutboundLink('http://github.com/michaelwschultz'); return false;">
                        github
                    </a> 
                    <a class="f6 f5-l link bg-animate black-80 hover-bg-light-red dib pa3 ph4-l"
                        href="http://instagram.com/michaelschultz"
                        onclick="trackOutboundLink('http://instagram.com/michaelschultz'); return false;">
                        Instagram
                    </a>
                    <a class="f6 f5-l link bg-animate black-80 hover-bg-light-purple dib pa3 ph4-l"
                        href="http://twitch.com/idigg"
                        onclick="trackOutboundLink('http://twitch.com/idigg'); return false;">
                        Twitch <span id="status" style="display: none;" class="bg-red white br2 ph1 f6">Live Now</span>
                    </a>
                </nav>
            </header>
        </section>
        <section>
            <h2 class="fw4 mt4">Some of my favorite artists...</h2>
            <h4 class="fw4 lh-copy">Here are my top 5 artists of the week based on plays. See all the music I listen to on <a href="http://last.fm/user/michaelschultz" class="link hover-dark-blue no-underline blue">Last.fm</a>.</h4>
            <div id="myLastFm" class="flexer mt4" style="height: 22rem;">
                <div id="firstArtist" class="flex w-100 h-100" style="flex-direction: column;">
                    <!-- get first arists and make it bigger -->
                </div>
                <div id="artists" class="flex w-100 h-100" style="flex-wrap: wrap;">
                    <!-- get arists -->
                </div>
            </div>
        </section>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
        <script>
            // check Twitch to see if I'm streaming
            function twitchStream() {
                $.ajax({
                    type: 'GET',
                    url: 'https://api.twitch.tv/kraken/streams/idigg',
                    headers: {
                       'Client-ID': 'huq9j1mhn1y324eetrl4o31sgazr27b'
                    },
                    success: function(channel) {
                        if (channel["stream"] == null) { 
                            console.log("stream offline");
                        } else {
                            console.log("stream online");
                            $("#status").css({"display": "inline-block"});
                        }
                    }
                });
            }

            // Add a listener that detects when tab is hidden
            document.addEventListener('visibilitychange', function(){
                if (document.hidden) {
                    clearInterval(checkTwitch);
                } else {
                    twitchStream();
                    checkTwitch = setInterval(twitchStream, 30000);
                }
            }, false);

            // run once when page loads
            twitchStream();

            // start checking every 30 seconds after page loads
            var checkTwitch = setInterval(twitchStream, 30000);
        </script>
        <script>
            const lastFm = () => {
                $.ajax({
                    type: 'GET',
                    url: 'https://ws.audioscrobbler.com/2.0/?method=user.gettopartists&user=michaelschultz&period=7day&api_key=a598c3064191ff18ee9756b6d8e41ea4&format=json',
                    success: function(data) {
                        if (data) {
                            let topArtists = data.topartists.artist;
                            let firstArtist = document.getElementById('firstArtist');
                            let artists = document.getElementById('artists');
                            let artistImage = "";

                            // iterate through and return 5 artists
                            for (let i = 0; i < 5; i++) {

                                // iterate through each artist and extract the image path
                                for (let r = 0; r < topArtists[i].image.length; r++) {
                                    if (topArtists[i].image[r].size == 'extralarge') {
                                        artistImage = topArtists[i].image[r]["#text"];
                                    }
                                }

                                // create a container for each artist and place their info inside
                                var artist = document.createElement('div');
                                artist.id = 'artist' + [i];
                                artist.style.backgroundImage = "url('" + artistImage +"')";
                                artist.style.backgroundRepeat = "no-repeat";
                                artist.innerHTML = "<p class='absolute bottom-0 pl2 f6 fw4 ttu tracked' style='z-index: 10;'>" + topArtists[i].name + "</p>";

                                // if this is the first artist give it some special treatment
                                if (i == 0) {
                                    artist.className = "artist relative cover darken w-100 white";
                                    artist.style.height = "22rem";
                                    firstArtist.appendChild(artist);
                                } else {
                                    artist.className = "artist relative cover darken w-50 h-50 h4 white";
                                    artists.appendChild(artist);
                                }
                            }   
                        } else {
                            console.log("something went wrong with the last.fm data");

                            let myLastFm = document.getElementById('lastFm');
                            myLastFm.innerHTML = "<p class='pl2 f6 fw4 ttu tracked'>Oops, something seems to be wrong with the Last.fm api. Maybe try refreshing once to see if it was just a glitch.</p>";
                        }
                    },
                    error: function(jqXHR, textStatus, errorThrown){
                        console.log("last.fm api wasn't able to be reached");

                        let myLastFm = document.getElementById('lastFm');
                        myLastFm.innerHTML = "<p class='pl2 f6 fw4 ttu tracked'>Oops, something seems to be wrong with the Last.fm api. Maybe try refreshing once to see if it was just a glitch.</p>";
                    }
                });
            }

            // render lastFm data
            lastFm();
        </script>
    </body>
</html>